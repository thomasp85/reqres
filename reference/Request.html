<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HTTP Request Handling — Request • reqres</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="HTTP Request Handling — Request"><meta name="description" content="This class wraps all functionality related to extracting information from a
http request. Much of the functionality is inspired by the Request class in
Express.js, so the documentation
for this will complement this document. As reqres is build on top of the
Rook specifications
the Request object is initialized from a Rook-compliant object. This will
often be the request object provided by the httpuv framework. While it
shouldn't be needed, the original Rook object is always accessible and can be
modified, though any modifications will not propagate to derived values in
the Request object (e.g. changing the HTTP_HOST element of the Rook
object will not change the host field of the Request object). Because of
this, direct manipulation of the Rook object is generally discouraged."><meta property="og:description" content="This class wraps all functionality related to extracting information from a
http request. Much of the functionality is inspired by the Request class in
Express.js, so the documentation
for this will complement this document. As reqres is build on top of the
Rook specifications
the Request object is initialized from a Rook-compliant object. This will
often be the request object provided by the httpuv framework. While it
shouldn't be needed, the original Rook object is always accessible and can be
modified, though any modifications will not propagate to derived values in
the Request object (e.g. changing the HTTP_HOST element of the Rook
object will not change the host field of the Request object). Because of
this, direct manipulation of the Rook object is generally discouraged."><meta property="og:image" content="https://reqres.data-imaginist.com/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">reqres</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Release notes</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.data-imaginist.com/2017/introducing-reqres/">Version 0.2.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Change log</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://fiery.data-imaginist.com">fiery</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://routr.data-imaginist.com">routr</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thomasp85/reqres"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>HTTP Request Handling</h1>
      <small class="dont-index">Source: <a href="https://github.com/thomasp85/reqres/blob/main/R/request.R" class="external-link"><code>R/request.R</code></a></small>
      <div class="d-none name"><code>Request.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This class wraps all functionality related to extracting information from a
http request. Much of the functionality is inspired by the Request class in
Express.js, so <a href="https://expressjs.com/en/4x/api.html#req" class="external-link">the documentation</a>
for this will complement this document. As <code>reqres</code> is build on top of the
<a href="https://github.com/jeffreyhorner/Rook/blob/a5e45f751/README.md" class="external-link">Rook specifications</a>
the <code>Request</code> object is initialized from a Rook-compliant object. This will
often be the request object provided by the <code>httpuv</code> framework. While it
shouldn't be needed, the original Rook object is always accessible and can be
modified, though any modifications will not propagate to derived values in
the <code>Request</code> object (e.g. changing the <code>HTTP_HOST</code> element of the Rook
object will not change the <code>host</code> field of the <code>Request</code> object). Because of
this, direct manipulation of the Rook object is generally discouraged.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">as.Request</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is.Request</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object coercible to a <code>Request</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Parameters passed on to <code>Request$new()</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>Request</code> object (for <code>as.Request()</code>) or a logical indicating whether
the object is a <code>Request</code> (for <code>is.Request()</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="initialization">Initialization<a class="anchor" aria-label="anchor" href="#initialization"></a></h2>


<p>A new 'Request'-object is initialized using the <code>new()</code> method on the
generator:</p>
<p><strong>Usage</strong></p><table class="table table"><tr><td><code>req &lt;- Request$new(rook, trust = FALSE)</code></td></tr></table></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Response.html">Response</a></code> for handling http responses</p></div>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>trust</code></dt>
<dd><p>A logical indicating whether the request is trusted. <em>Mutable</em></p></dd>


<dt><code>method</code></dt>
<dd><p>A string indicating the request method (in lower case, e.g.
'get', 'put', etc.). <em>Immutable</em></p></dd>


<dt><code>body</code></dt>
<dd><p>An object holding the body of the request. This is an empty
string by default and needs to be populated using the <code>set_body()</code> method
(this is often done using a body parser that accesses the Rook$input
stream). <em>Immutable</em></p></dd>


<dt><code>session</code></dt>
<dd><p>The content of the session cookie. If session cookies has
not been activated it will be an empty write-protected list. If session
cookies are activated but the request did not contain one it will be an
empty list. The content of this field will be send encrypted as part of
the response according to the cookie settings in
<code>$session_cookie_settings</code>. This field is reflected in the
<code>Response$session</code> field and using either produces the same result</p></dd>


<dt><code>has_session_cookie</code></dt>
<dd><p>Query whether the request came with a session
cookie <em>Immutable</em></p></dd>


<dt><code>session_cookie_settings</code></dt>
<dd><p>Get the settings for the session cookie as
they were provided during initialisation
cookie <em>Immutable</em></p></dd>


<dt><code>has_key</code></dt>
<dd><p>Query whether the request was initialised with an
encryption key <em>Immutable</em></p></dd>


<dt><code>compression_limit</code></dt>
<dd><p>Query the compression limit the request was
initialized with <em>Immutable</em></p></dd>


<dt><code>cookies</code></dt>
<dd><p>Access a named list of all cookies in the request. These
have been URI decoded. <em>Immutable</em></p></dd>


<dt><code>headers</code></dt>
<dd><p>Access a named list of all headers in the request. In
order to follow R variable naming standards <code>-</code> have been substituted
with <code>_</code>. Use the <code>get_header()</code> method to lookup based on the correct
header name. <em>Immutable</em></p></dd>


<dt><code>host</code></dt>
<dd><p>Return the domain of the server given by the "Host" header if
<code>trust == FALSE</code>. If <code>trust == true</code> returns the <code>X-Forwarded-Host</code>
instead. <em>Immutable</em></p></dd>


<dt><code>ip</code></dt>
<dd><p>Returns the remote address of the request if <code>trust == FALSE</code>.
If <code>trust == TRUE</code> it will instead return the first value of the
<code>X-Forwarded-For</code> header. <em>Immutable</em></p></dd>


<dt><code>ips</code></dt>
<dd><p>If <code>trust == TRUE</code> it will return the full list of ips in the
<code>X-Forwarded-For</code> header. If <code>trust == FALSE</code> it will return an empty
vector. <em>Immutable</em></p></dd>


<dt><code>protocol</code></dt>
<dd><p>Returns the protocol (e.g. 'http') used for the request.
If <code>trust == TRUE</code> it will use the value of the <code>X-Forwarded-Proto</code> header.
<em>Immutable</em></p></dd>


<dt><code>root</code></dt>
<dd><p>The mount point of the application receiving this request.
Can be empty if the application is mounted on the server root.
<em>Immutable</em></p></dd>


<dt><code>path</code></dt>
<dd><p>The part of the url following the root. Defines the local
target of the request (independent of where it is mounted). <em>Immutable</em></p></dd>


<dt><code>url</code></dt>
<dd><p>The full URL of the request. <em>Immutable</em></p></dd>


<dt><code>query</code></dt>
<dd><p>The query string of the request (anything following "?" in
the URL) parsed into a named list. The query has been url decoded and "+"
has been substituted with space. Multiple queries are expected to be
separated by either "&amp;" or "|". <em>Immutable</em></p></dd>


<dt><code>query_delim</code></dt>
<dd><p>The delimiter used for specifying multiple values in a
query. If <code>NULL</code> then queries are expected to contain multiple key-value
pairs for the same key in order to provide an array, e.g.
<code>?arg1=3&amp;arg1=7</code>. If setting it to <code>",""</code>, <code>"|"</code>, or <code>" "</code> then an array
can be provided in a single key-value pair, e.g. <code>?arg1=3|7</code></p></dd>


<dt><code>querystring</code></dt>
<dd><p>The unparsed query string of the request, including
"?". If no query string exists it will be <code>""</code> rather than <code>"?"</code></p></dd>


<dt><code>xhr</code></dt>
<dd><p>A logical indicating whether the <code>X-Requested-With</code> header
equals <code>XMLHttpRequest</code> thus indicating that the request was performed
using JavaScript library such as jQuery. <em>Immutable</em></p></dd>


<dt><code>secure</code></dt>
<dd><p>A logical indicating whether the request was performed
using a secure connection, i.e. <code>protocol == 'https'</code>. <em>Immutable</em></p></dd>


<dt><code>origin</code></dt>
<dd><p>The original object used to create the <code>Request</code> object. As
<code>reqres</code> currently only works with rook this will always return the
original rook object. Changing this will force the request to reparse
itself.</p></dd>


<dt><code>response</code></dt>
<dd><p>If a <code>Response</code> object has been created for this request
it is accessible through this field. <em>Immutable</em></p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Request-new"><code>Request$new()</code></a></p></li>
<li><p><a href="#method-Request-print"><code>Request$print()</code></a></p></li>
<li><p><a href="#method-Request-set_body"><code>Request$set_body()</code></a></p></li>
<li><p><a href="#method-Request-set_cookies"><code>Request$set_cookies()</code></a></p></li>
<li><p><a href="#method-Request-accepts"><code>Request$accepts()</code></a></p></li>
<li><p><a href="#method-Request-accepts_charsets"><code>Request$accepts_charsets()</code></a></p></li>
<li><p><a href="#method-Request-accepts_encoding"><code>Request$accepts_encoding()</code></a></p></li>
<li><p><a href="#method-Request-accepts_language"><code>Request$accepts_language()</code></a></p></li>
<li><p><a href="#method-Request-is"><code>Request$is()</code></a></p></li>
<li><p><a href="#method-Request-get_header"><code>Request$get_header()</code></a></p></li>
<li><p><a href="#method-Request-respond"><code>Request$respond()</code></a></p></li>
<li><p><a href="#method-Request-parse"><code>Request$parse()</code></a></p></li>
<li><p><a href="#method-Request-parse_raw"><code>Request$parse_raw()</code></a></p></li>
<li><p><a href="#method-Request-as_message"><code>Request$as_message()</code></a></p></li>
<li><p><a href="#method-Request-encode_string"><code>Request$encode_string()</code></a></p></li>
<li><p><a href="#method-Request-decode_string"><code>Request$decode_string()</code></a></p></li>
<li><p><a href="#method-Request-clear"><code>Request$clear()</code></a></p></li>
<li><p><a href="#method-Request-forward"><code>Request$forward()</code></a></p></li>
<li><p><a href="#method-Request-clone"><code>Request$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Request-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new request from a rook object</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Request.html">Request</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">rook</span>,</span>
<span>  trust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  key <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  session_cookie <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  compression_limit <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>rook</code></dt>
<dd><p>The <a href="https://github.com/jeffreyhorner/Rook/blob/a5e45f751/README.md" class="external-link">rook</a> object to base the request on</p></dd>


<dt><code>trust</code></dt>
<dd><p>Is this request trusted blindly. If <code>TRUE</code> <code>X-Forwarded-*</code>
headers will be returned when querying host, ip, and protocol</p></dd>


<dt><code>key</code></dt>
<dd><p>A 32-bit secret key as a hex encoded string or a raw vector to
use for <code>$encode_string()</code> and <code>$decode_string()</code> and by extension to
encrypt a session cookie. It must be given to turn on session cookie
support. A valid key can be generated using <code><a href="random_key.html">random_key()</a></code>. NEVER STORE
THE KEY IN PLAIN TEXT. Optimalle use the keyring package to store it or
set it as an environment variable</p></dd>


<dt><code>session_cookie</code></dt>
<dd><p>Settings for the session cookie created using
<code><a href="session_cookie.html">session_cookie()</a></code>. Will be ignored if <code>key</code> is not provided to ensure
session cookies are properly encrypted</p></dd>


<dt><code>compression_limit</code></dt>
<dd><p>The size threshold in bytes for trying to
compress the response body (it is still dependant on content negotiation)</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Pretty printing of the object</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>ignored</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-set_body"></a><div class="section">
<h3 id="method-set-body-">Method <code>set_body()</code><a class="anchor" aria-label="anchor" href="#method-set-body-"></a></h3>
<p>Sets the content of the request body. This method should
mainly be used in concert with a body parser that reads the <code>rook$input</code>
stream</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">set_body</span><span class="op">(</span><span class="va">content</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>content</code></dt>
<dd><p>An R object representing the body of the request</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-set_cookies"></a><div class="section">
<h3 id="method-set-cookies-">Method <code>set_cookies()</code><a class="anchor" aria-label="anchor" href="#method-set-cookies-"></a></h3>
<p>Sets the cookies of the request. The cookies are
automatically parsed and populated, so this method is mainly available
to facilitate cookie signing and encryption</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">set_cookies</span><span class="op">(</span><span class="va">cookies</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>cookies</code></dt>
<dd><p>A named list of cookie values</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-accepts"></a><div class="section">
<h3 id="method-accepts-">Method <code>accepts()</code><a class="anchor" aria-label="anchor" href="#method-accepts-"></a></h3>
<p>Given a vector of response content types it returns the
preferred one based on the <code>Accept</code> header.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">accepts</span><span class="op">(</span><span class="va">types</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>types</code></dt>
<dd><p>A vector of types</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-accepts_charsets"></a><div class="section">
<h3 id="method-accepts-charsets-">Method <code>accepts_charsets()</code><a class="anchor" aria-label="anchor" href="#method-accepts-charsets-"></a></h3>
<p>Given a vector of possible character encodings it returns
the preferred one based on the <code>Accept-Charset</code> header.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">accepts_charsets</span><span class="op">(</span><span class="va">charsets</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>charsets</code></dt>
<dd><p>A vector of charsets</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-accepts_encoding"></a><div class="section">
<h3 id="method-accepts-encoding-">Method <code>accepts_encoding()</code><a class="anchor" aria-label="anchor" href="#method-accepts-encoding-"></a></h3>
<p>Given a vector of possible content encodings (usually
compression algorithms) it selects the preferred one based on the
<code>Accept-Encoding</code> header. If there is no match it will return <code>"identity"</code>
signaling no compression.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">accepts_encoding</span><span class="op">(</span><span class="va">encoding</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>encoding</code></dt>
<dd><p>A vector of encoding names</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-accepts_language"></a><div class="section">
<h3 id="method-accepts-language-">Method <code>accepts_language()</code><a class="anchor" aria-label="anchor" href="#method-accepts-language-"></a></h3>
<p>Given a vector of possible content languages it selects the
best one based on the <code>Accept-Language</code> header.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">accepts_language</span><span class="op">(</span><span class="va">language</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>language</code></dt>
<dd><p>A vector of languages</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-is"></a><div class="section">
<h3 id="method-is-">Method <code>is()</code><a class="anchor" aria-label="anchor" href="#method-is-"></a></h3>
<p>Queries whether the body of the request is in a given format
by looking at the <code>Content-Type</code> header. Used for selecting the best
parsing method.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">is</span><span class="op">(</span><span class="va">type</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>type</code></dt>
<dd><p>A vector of content types to check for. Can be fully
qualified MIME types, a file extension, or a mime type with wildcards</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-get_header"></a><div class="section">
<h3 id="method-get-header-">Method <code>get_header()</code><a class="anchor" aria-label="anchor" href="#method-get-header-"></a></h3>
<p>Get the header of the specified name.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">get_header</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>The name of the header to get</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-respond"></a><div class="section">
<h3 id="method-respond-">Method <code>respond()</code><a class="anchor" aria-label="anchor" href="#method-respond-"></a></h3>
<p>Creates a new <code>Response</code> object from the request</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">respond</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Request-parse"></a><div class="section">
<h3 id="method-parse-">Method <code><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse()</a></code><a class="anchor" aria-label="anchor" href="#method-parse-"></a></h3>
<p>Based on provided parsers it selects the appropriate one by
looking at the <code>Content-Type</code> header and assigns the result to the
request body. A parser is a function accepting a raw vector, and a named
list of additional directives, and returns an R object of any kind (if
the parser knows the input to be plain text, simply wrap it in
<code><a href="https://rdrr.io/r/base/rawConversion.html" class="external-link">rawToChar()</a></code>). If the body is compressed, it will be decompressed based
on the <code>Content-Encoding</code> header prior to passing it on to the parser.
See <a href="parsers.html">parsers</a> for a list of pre-supplied parsers. Parsers are either
supplied in a named list or as named arguments to the parse method. The
names should correspond to mime types or known file extensions. If
<code>autofail = TRUE</code> the response will be set with the correct error code if
parsing fails. <code><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse()</a></code> returns <code>TRUE</code> if parsing was successful and
<code>FALSE</code> if not</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">parse</span><span class="op">(</span><span class="va">...</span>, autofail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>A named set of parser functions</p></dd>


<dt><code>autofail</code></dt>
<dd><p>Automatically populate the response if parsing fails</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-parse_raw"></a><div class="section">
<h3 id="method-parse-raw-">Method <code>parse_raw()</code><a class="anchor" aria-label="anchor" href="#method-parse-raw-"></a></h3>
<p>This is a simpler version of the <code><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse()</a></code> method. It will
attempt to decompress the body and set the <code>body</code> field to the resulting
raw vector. It is then up to the server to decide how to handle the
payload. It returns <code>TRUE</code> if successful and <code>FALSE</code> otherwise.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">parse_raw</span><span class="op">(</span>autofail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>autofail</code></dt>
<dd><p>Automatically populate the response if parsing fails</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-as_message"></a><div class="section">
<h3 id="method-as-message-">Method <code>as_message()</code><a class="anchor" aria-label="anchor" href="#method-as-message-"></a></h3>
<p>Prints a HTTP representation of the request to the output
stream.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">as_message</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Request-encode_string"></a><div class="section">
<h3 id="method-encode-string-">Method <code>encode_string()</code><a class="anchor" aria-label="anchor" href="#method-encode-string-"></a></h3>
<p>base64-encode a string. If a key has been provided during
initialisation the string is first encrypted and the final result is a
combination of the encrypted text and the nonce, both base64 encoded and
combined with a <code>"_"</code>.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">encode_string</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>val</code></dt>
<dd><p>A single string to encrypt</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-decode_string"></a><div class="section">
<h3 id="method-decode-string-">Method <code>decode_string()</code><a class="anchor" aria-label="anchor" href="#method-decode-string-"></a></h3>
<p>base64-decodes a string. If a key has been provided during
initialisation the input is first split by <code>"_"</code> and then the two parts
are base64 decoded and decrypted. Otherwise the input is base64-decoded
as-is. It will always hold that
<code>val == decode_string(encode_string(val))</code>.</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">decode_string</span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>val</code></dt>
<dd><p>A single string to encrypt</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-clear"></a><div class="section">
<h3 id="method-clear-">Method <code>clear()</code><a class="anchor" aria-label="anchor" href="#method-clear-"></a></h3>
<p>Clears the content of the request and, if created, the
related response. This method exists only to allow reuse of the request
and response object to save a few milliseconds in latency. Use with
caution and see e.g. how fiery maintains a poll of request objects</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">clear</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Request-forward"></a><div class="section">
<h3 id="method-forward-">Method <code>forward()</code><a class="anchor" aria-label="anchor" href="#method-forward-"></a></h3>
<p>Forward a request to a new url, optionally setting different
headers, queries, etc. Uses httr2 under the hood</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">forward</span><span class="op">(</span></span>
<span>  <span class="va">url</span>,</span>
<span>  query <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  headers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  body <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-15">Arguments<a class="anchor" aria-label="anchor" href="#arguments-15"></a></h4>
<p></p><div class="arguments"><dl><dt><code>url</code></dt>
<dd><p>The url to forward to</p></dd>


<dt><code>query</code></dt>
<dd><p>Optional querystring to append to <code>url</code>. If <code>NULL</code> the query
string of the current request will be used</p></dd>


<dt><code>method</code></dt>
<dd><p>The HTTP method to use. If <code>NULL</code> the method of the current
request will be used</p></dd>


<dt><code>headers</code></dt>
<dd><p>A list of headers to add to the headers of the current
request. You can remove a header from the current request by setting it
to <code>NULL</code> here</p></dd>


<dt><code>body</code></dt>
<dd><p>The body to send with the forward. If <code>NULL</code> the body of the
current request will be used</p></dd>


<dt><code>...</code></dt>
<dd><p>Additional arguments passed to <code><a href="https://httr2.r-lib.org/reference/req_options.html" class="external-link">httr2::req_options()</a></code></p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Request-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Request</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-16">Arguments<a class="anchor" aria-label="anchor" href="#arguments-16"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">fake_rook</span> <span class="op">&lt;-</span> <span class="fu">fiery</span><span class="fu">::</span><span class="fu"><a href="https://fiery.data-imaginist.com/reference/fake_request.html" class="external-link">fake_request</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'http://example.com/test?id=34632&amp;question=who+is+hadley'</span>,</span></span>
<span class="r-in"><span>  content <span class="op">=</span> <span class="st">'This is an elaborate ruse'</span>,</span></span>
<span class="r-in"><span>  headers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Accept <span class="op">=</span> <span class="st">'application/json; text/*'</span>,</span></span>
<span class="r-in"><span>    Content_Type <span class="op">=</span> <span class="st">'text/plain'</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">req</span> <span class="op">&lt;-</span> <span class="va">Request</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">fake_rook</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get full URL</span></span></span>
<span class="r-in"><span><span class="va">req</span><span class="op">$</span><span class="va">url</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "http://example.com:80/test?id=34632&amp;question=who+is+hadley"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get list of query parameters</span></span></span>
<span class="r-in"><span><span class="va">req</span><span class="op">$</span><span class="va">query</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "34632"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $question</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "who is hadley"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test if content is text</span></span></span>
<span class="r-in"><span><span class="va">req</span><span class="op">$</span><span class="fu">is</span><span class="op">(</span><span class="st">'txt'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"pick")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform content negotiation for the response</span></span></span>
<span class="r-in"><span><span class="va">req</span><span class="op">$</span><span class="fu">accepts</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'html'</span>, <span class="st">'json'</span>, <span class="st">'txt'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "json"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cleaning up connections</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">fake_rook</span>, <span class="va">req</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           used (Mb) gc trigger  (Mb) max used  (Mb)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ncells 1137131 60.8    2210281 118.1  2210281 118.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vcells 2122278 16.2    8388608  64.0  3065300  23.4</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://data-imaginist.com" class="external-link">Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

